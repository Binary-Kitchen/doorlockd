# Author: Ralf Ramsauer <ralf@binary-kitchen.de>

pkgname=doorlockd
pkgver=2.0
pkgrel=1
pkgdesc="Binary Kitchen's doorlockd"
arch=('any')
url="https://github.com/Binary-Kitchen/${pkgname}"
license=(GPL)
depends=('python3'
         'python-ldap'
	 'python-pip'
	 'alsa-utils'
	 'mosquitto'
	 'wol'
	 'python-flask-wtf'
	 'python-flask-socketio'
	 'chromium'
	 'xf86-video-fbdev'
	 'fluxbox'
	 'nginx'
	 'slim')
source=("git+https://github.com/Binary-Kitchen/${pkgname}.git#branch=next"
        "https://www.binary-kitchen.de/static/BKCA.crt")
sha256sums=('SKIP'
            '2e8b1ffabcf16e3e60cfc277b40955ae499dedcf39762efbb0512003be9db10f')

build() {
  cd "$srcdir/$pkgname/"
  make PREFIX=/usr sysconfdir=/etc
  cp -v ../BKCA.crt .
}

package() {
  install=${pkgname}.install
  cd "$srcdir/$pkgname/"
  make PREFIX=/usr sysconfdir=/etc DESTDIR="$pkgdir" install
  mkdir -p $pkgdir/etc/ca-certificates/trust-source/anchors
  cp -v BKCA.crt $pkgdir/etc/ca-certificates/trust-source/anchors
}
